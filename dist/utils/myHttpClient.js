"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_request=require("./request.js"),_request2=_interopRequireDefault(_request),_getHeaderUrl=Symbol("_getHeaderUrl"),signatureUtil=require("./HSSignatureUtil.js"),HSHttpClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";_classCallCheck(this,e),this.urlParams=new Map,this.realUrl=t,this[_getHeaderUrl](r),this.newUrl=this.getSignRequestUrl(n,l)}return _createClass(e,[{key:_getHeaderUrl,value:function(e){for(var t in e.data)e.routerUrl=e.routerUrl.replace(t,encodeURIComponent(e.data[t])),this.urlParams.set(t,e.data[t]);e.routerUrl&&(this.realUrl=this.realUrl+e.routerUrl+"/")}},{key:"getSignRequestUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="";if(e)for(var n in e)r+="&"+n+"="+encodeURIComponent(e[n]),this.urlParams.set(n,e[n]);var l=signatureUtil.getTimeStamp(),i=signatureUtil.getRandom(5),a=signatureUtil.makeSignPlain(this.urlParams,t,l,i);return this.realUrl+"?timestamp="+l+"&nonce="+i+"&signature="+a+r}}]),e}(),API={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=new HSHttpClient(e,t,r).newUrl;return _request2.default.https(l,"GET","",n)},post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=new HSHttpClient(e,t),i=l.getSignRequestUrl(r,n);return _request2.default.https(i,"POST",n)},delete:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=new HSHttpClient(e,t),i=l.getSignRequestUrl(r,n);return _request2.default.https(i,"DELETE",n)},put:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=new HSHttpClient(e,t),i=l.getSignRequestUrl(r,n);return _request2.default.https(i,"PUT",n)}};exports.default=API;