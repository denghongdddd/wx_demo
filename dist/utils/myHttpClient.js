"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_request=require("./request.js"),_request2=_interopRequireDefault(_request),_getHeaderUrl=Symbol("_getHeaderUrl"),signatureUtil=require("./HSSignatureUtil.js"),HSHttpClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";_classCallCheck(this,e),this.urlParams=new Map,this.realUrl=t,this[_getHeaderUrl](r),this.newUrl=this.getSignRequestUrl(n,i)}return _createClass(e,[{key:_getHeaderUrl,value:function(e){for(var t in e)this.realUrl=this.realUrl.replace(new RegExp("(?<=\\/):"+t+"(?<=\\/|\\b)"),encodeURIComponent(e[t])),this.urlParams.set(t,e[t])}},{key:"getSignRequestUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="";if(e)for(var n in e)r+="&"+n+"="+encodeURIComponent(e[n]),this.urlParams.set(n,e[n]);var i=signatureUtil.getTimeStamp(),a=signatureUtil.getRandom(5),l=signatureUtil.makeSignPlain(this.urlParams,t,i,a);return this.realUrl+"?timestamp="+i+"&nonce="+a+"&signature="+l+r}}]),e}(),API={get:function(e){var t=e.url,r=e.routerParms,n=void 0===r?{}:r,i=e.params,a=void 0===i?{}:i,l=e.headers,u=void 0===l?{}:l,s=new HSHttpClient(t,n,a).newUrl;return _request2.default.https(s,"GET","",u)},post:function(e){var t=e.urlOld,r=e.routerParms,n=void 0===r?{}:r,i=e.interrogationParms,a=void 0===i?{}:i,l=e.bodyParms,u=void 0===l?{}:l,s=new HSHttpClient(t,n),o=s.getSignRequestUrl(a,u);return _request2.default.https(o,"POST",u)},delete:function(e){var t=e.urlOld,r=e.routerParms,n=void 0===r?{}:r,i=e.interrogationParms,a=void 0===i?{}:i,l=e.bodyParms,u=void 0===l?{}:l,s=new HSHttpClient(t,n),o=s.getSignRequestUrl(a,u);return _request2.default.https(o,"DELETE",u)},put:function(e){var t=e.urlOld,r=e.routerParms,n=void 0===r?{}:r,i=e.interrogationParms,a=void 0===i?{}:i,l=e.bodyParms,u=void 0===l?{}:l,s=new HSHttpClient(t,n),o=s.getSignRequestUrl(a,u);return _request2.default.https(o,"PUT",u)}};exports.default=API;